{% extends "admin/change_list.html" %}
{% load i18n admin_list %}

{% block object-tools-items %}
    
    <li>  
           {% comment %} Don't append DOMAIN_URL to the url below {% endcomment %}
        <a href="#" onclick="refresh_threads('{% url 'gmail_get_unread_messages' %}');" class="">Refresh</a>
    </li>
    <li>
        {% comment %} Don't append DOMAIN_URL to the url below {% endcomment %}
        <a href={% url 'authorize_gmail_credentials' %} class="">Reauthorize Gmail Credentials</a>
    </li>
    {{block.super}} 
{% endblock %}

{% block content %}
  {{block.super}}
  <script type="text/javascript">
      function refresh_threads(url) {
          fetch(url, {
            method: 'GET'
          }).then(response => {
              if(!response.ok) {
                  alert(response.statusText);
              }
              location.reload()
            }).catch(error => {
                alert(error);
            }); 
      };
  </script> 
{% endblock %}